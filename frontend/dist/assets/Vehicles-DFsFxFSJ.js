import{d as we,b as Te,r as p,c as Y,Q as Z,R as Ne,a1 as Me,e as $,h as l,w as a,i,a8 as x,g as s,t as n,M as d,L as F,N as ee,aa as le,ab as te,E as _,o as g,O as Ue,ac as ae,_ as Ae}from"./index-CC1QUR8I.js";import{i as Se}from"./index-BfzQXryb.js";const De={class:"vehicles-container"},Le={class:"header-content"},Ke={class:"header-actions"},Pe={class:"stat-content"},Re={class:"stat-icon running"},Ee={class:"stat-info"},Fe={class:"stat-number"},Ie={class:"stat-label"},We={class:"stat-content"},Be={class:"stat-icon idle"},ze={class:"stat-info"},He={class:"stat-number"},Oe={class:"stat-label"},je={class:"stat-content"},Qe={class:"stat-icon maintenance"},qe={class:"stat-info"},Ge={class:"stat-number"},Je={class:"stat-label"},Xe={class:"stat-content"},Ye={class:"stat-icon offline"},Ze={class:"stat-info"},xe={class:"stat-number"},el={class:"stat-label"},ll={class:"card-header"},tl={class:"map-controls"},al={key:0,class:"track-controls"},sl={class:"track-info"},nl={class:"track-player"},ol={class:"card-header"},il={class:"vehicle-list"},dl=["onClick"],cl={class:"vehicle-info"},ul={class:"vehicle-header"},rl={class:"plate-number"},pl={class:"vehicle-details"},ml={class:"vehicle-actions"},vl={key:0,class:"vehicle-detail"},hl={style:{"margin-top":"20px"}},fl={class:"dialog-footer"},_l=we({__name:"Vehicles",setup(gl){const{t:c}=Te(),b=p("realtime"),C=p(""),M=p(""),I=p(new Date),W=p(""),w=p(0),S=p(!1),T=p(!1),r=p(null),y=p(),D=p(null),L=p(),U=Y({running:35,idle:12,maintenance:3,offline:0}),m=Y({vehicle:"",type:"",note:""}),B=[{id:"V001",plateNumber:"WA123ABC",driverKey:"zhangsan",phone:"0412345678",model:"Toyota Hilux",status:"running",locationKey:"perthCBD",speed:45,fuel:75,mileage:15420,lat:-31.9505,lng:115.8605,lastUpdate:2},{id:"V002",plateNumber:"WA456DEF",driverKey:"lisi",phone:"0423456789",model:"Ford Ranger",status:"idle",locationKey:"fremantle",speed:0,fuel:60,mileage:22100,lat:-32.0569,lng:115.744,lastUpdate:5},{id:"V003",plateNumber:"WA789GHI",driverKey:"wangwu",phone:"0434567890",model:"Isuzu D-MAX",status:"running",locationKey:"joondalup",speed:60,fuel:85,mileage:8750,lat:-31.7448,lng:115.7661,lastUpdate:1},{id:"V004",plateNumber:"WA012JKL",driverKey:"zhaoliu",phone:"0445678901",model:"Mitsubishi Triton",status:"maintenance",locationKey:"malaga",speed:0,fuel:30,mileage:34580,lat:-31.8645,lng:115.8985,lastUpdate:120},{id:"V005",plateNumber:"WA345MNO",driverKey:"sunqi",phone:"0456789012",model:"Nissan Navara",status:"running",locationKey:"rockingham",speed:55,fuel:90,mileage:12340,lat:-32.2767,lng:115.7295,lastUpdate:3}],N=Z(()=>B.map(e=>({...e,driver:c(`vehicles.drivers.${e.driverKey}`),location:c(`vehicles.locations.${e.locationKey}`),lastUpdate:se(e.lastUpdate)}))),se=e=>{if(e>=60){const t=Math.floor(e/60);return t===1?c("time.hourAgo",{n:t}):c("time.hoursAgo",{n:t})}else return e===1?c("time.minuteAgo",{n:e}):c("time.minutesAgo",{n:e})},ne=Z(()=>M.value?N.value.filter(e=>e.plateNumber.toLowerCase().includes(M.value.toLowerCase())):N.value),z=e=>{b.value=e,ve()},oe=()=>{_.success(c("vehicles.dataRefreshed"))},ie=e=>{C.value=e;const t=N.value.find(u=>u.id===e);t&&D.value&&me(t)},de=e=>{r.value=e,S.value=!0,x(()=>{he()})},ce=e=>{m.vehicle=`${e.plateNumber} - ${e.driver}`,T.value=!0},ue=()=>{_.success(c("vehicles.commandSend")+`: ${m.vehicle}`),T.value=!1,Object.assign(m,{vehicle:"",type:"",note:""})},re=()=>{if(!C.value){_.warning(c("vehicles.selectVehicleFirst"));return}_.info(c("vehicles.playTrackStart"));const e=setInterval(()=>{w.value+=5,w.value>=100&&(clearInterval(e),_.success(c("vehicles.playTrackFinished")))},500)},pe=()=>{_.info(c("vehicles.playTrackPaused"))},H=e=>({running:"success",idle:"warning",maintenance:"danger",offline:"info"})[e]||"info",O=e=>({running:c("status.running"),idle:c("status.idle"),maintenance:c("status.maintenance"),offline:c("status.offline")})[e]||c("common.unknown"),K=()=>{x(()=>{if(!y.value)return;const e=document.createElement("canvas");e.width=y.value.offsetWidth,e.height=400,e.style.width="100%",e.style.height="400px",e.style.border="1px solid #ddd",e.style.borderRadius="4px",e.style.background="#f0f0f0";const t=e.getContext("2d");t&&(t.fillStyle="#e8f4f8",t.fillRect(0,0,e.width,e.height),t.strokeStyle="#666",t.lineWidth=2,t.beginPath(),t.rect(50,50,e.width-100,e.height-100),t.stroke(),t.fillStyle="#333",t.font="16px Arial",t.fillText("Perth Metropolitan Area",60,80),N.value.forEach((u,P)=>{const A=100+P*80+Math.random()*40,v=120+Math.random()*200,h={running:"#67C23A",idle:"#E6A23C",maintenance:"#F56C6C",offline:"#909399"};t.fillStyle=h[u.status]||"#909399",t.beginPath(),t.arc(A,v,8,0,2*Math.PI),t.fill(),t.fillStyle="#333",t.font="12px Arial",t.fillText(u.plateNumber,A-30,v+25)}),y.value&&(y.value.innerHTML="",y.value.appendChild(e)),D.value=e)})},me=e=>{_.info(c("vehicles.focusVehicle",{plate:e.plateNumber}))},ve=()=>{_.info(b.value==="realtime"?c("vehicles.switchRealtime"):c("vehicles.switchTrack")),K()},he=()=>{if(!L.value)return;const e=Se(L.value),t={tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","24:00"]},yAxis:{type:"value",name:"里程 (km)"},series:[{name:"累计里程",type:"line",data:[0,15,45,120,180,220,250],smooth:!0,itemStyle:{color:"#409EFF"},areaStyle:{color:"rgba(64, 158, 255, 0.1)"}}]};e.setOption(t)};return Ne(()=>{K(),setInterval(()=>{B.forEach(e=>{e.status==="running"&&(e.speed=Math.floor(Math.random()*80)+20,e.lastUpdate=Math.floor(Math.random()*5)+1)})},1e4)}),Me(()=>y.value?.offsetWidth,()=>{D.value&&setTimeout(K,100)}),(e,t)=>{const u=i("el-button"),P=i("el-button-group"),A=i("Refresh"),v=i("el-icon"),h=i("el-card"),fe=i("CaretRight"),k=i("el-col"),j=i("VideoPause"),_e=i("Tools"),ge=i("Close"),Q=i("el-row"),V=i("el-option"),q=i("el-select"),ye=i("VideoPlay"),be=i("el-date-picker"),ke=i("el-time-picker"),Ve=i("el-slider"),R=i("el-input"),G=i("el-tag"),f=i("el-descriptions-item"),$e=i("el-descriptions"),J=i("el-dialog"),E=i("el-form-item"),Ce=i("el-form");return g(),$("div",De,[l(h,{class:"page-header"},{default:a(()=>[s("div",Le,[s("h1",null,n(e.$t("vehicles.title")),1),s("div",Ke,[l(P,null,{default:a(()=>[l(u,{type:b.value==="realtime"?"primary":"default",onClick:t[0]||(t[0]=o=>z("realtime"))},{default:a(()=>[d(n(e.$t("vehicles.realtime")),1)]),_:1},8,["type"]),l(u,{type:b.value==="track"?"primary":"default",onClick:t[1]||(t[1]=o=>z("track"))},{default:a(()=>[d(n(e.$t("vehicles.track")),1)]),_:1},8,["type"])]),_:1}),t[13]||(t[13]=d()),l(u,{type:"success",onClick:oe},{default:a(()=>[l(v,null,{default:a(()=>[l(A)]),_:1}),d(" "+n(e.$t("vehicles.refreshData")),1)]),_:1})])])]),_:1}),l(Q,{gutter:20,class:"stats-section"},{default:a(()=>[l(k,{span:6},{default:a(()=>[l(h,{class:"stat-card"},{default:a(()=>[s("div",Pe,[s("div",Re,[l(v,null,{default:a(()=>[l(fe)]),_:1})]),s("div",Ee,[s("div",Fe,n(U.running),1),s("div",Ie,n(e.$t("status.running")),1)])])]),_:1})]),_:1}),l(k,{span:6},{default:a(()=>[l(h,{class:"stat-card"},{default:a(()=>[s("div",We,[s("div",Be,[l(v,null,{default:a(()=>[l(j)]),_:1})]),s("div",ze,[s("div",He,n(U.idle),1),s("div",Oe,n(e.$t("status.idle")),1)])])]),_:1})]),_:1}),l(k,{span:6},{default:a(()=>[l(h,{class:"stat-card"},{default:a(()=>[s("div",je,[s("div",Qe,[l(v,null,{default:a(()=>[l(_e)]),_:1})]),s("div",qe,[s("div",Ge,n(U.maintenance),1),s("div",Je,n(e.$t("status.maintenance")),1)])])]),_:1})]),_:1}),l(k,{span:6},{default:a(()=>[l(h,{class:"stat-card"},{default:a(()=>[s("div",Xe,[s("div",Ye,[l(v,null,{default:a(()=>[l(ge)]),_:1})]),s("div",Ze,[s("div",xe,n(U.offline),1),s("div",el,n(e.$t("status.offline")),1)])])]),_:1})]),_:1})]),_:1}),l(Q,{gutter:20,class:"main-content"},{default:a(()=>[l(k,{span:16},{default:a(()=>[l(h,null,{header:a(()=>[s("div",ll,[s("span",null,n(e.$t("vehicles.mapTitle")),1),s("div",tl,[l(q,{modelValue:C.value,"onUpdate:modelValue":t[2]||(t[2]=o=>C.value=o),placeholder:e.$t("vehicles.selectVehicle"),style:{width:"200px"}},{default:a(()=>[(g(!0),$(le,null,te(N.value,o=>(g(),ee(V,{key:o.id,label:`${o.plateNumber} - ${o.driver}`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),b.value==="track"?(g(),ee(u,{key:0,type:"primary",onClick:re,style:{"margin-left":"10px"}},{default:a(()=>[l(v,null,{default:a(()=>[l(ye)]),_:1}),d(" "+n(e.$t("vehicles.playTrack")),1)]),_:1})):F("",!0)])])]),default:a(()=>[s("div",{ref_key:"mapContainer",ref:y,class:"map-container"},null,512),b.value==="track"?(g(),$("div",al,[s("div",sl,[s("span",null,n(e.$t("vehicles.trackPlayback")),1),l(be,{modelValue:I.value,"onUpdate:modelValue":t[3]||(t[3]=o=>I.value=o),type:"date",placeholder:e.$t("vehicles.trackDate"),style:{width:"150px",margin:"0 10px"}},null,8,["modelValue","placeholder"]),l(ke,{modelValue:W.value,"onUpdate:modelValue":t[4]||(t[4]=o=>W.value=o),format:"HH:mm",placeholder:e.$t("vehicles.trackTime"),style:{width:"120px","margin-right":"10px"}},null,8,["modelValue","placeholder"])]),s("div",nl,[l(u,{onClick:pe},{default:a(()=>[l(v,null,{default:a(()=>[l(j)]),_:1})]),_:1}),l(Ve,{modelValue:w.value,"onUpdate:modelValue":t[5]||(t[5]=o=>w.value=o),max:100,style:{flex:"1",margin:"0 15px"}},null,8,["modelValue"]),s("span",null,n(w.value)+"%",1)])])):F("",!0)]),_:1})]),_:1}),l(k,{span:8},{default:a(()=>[l(h,null,{header:a(()=>[s("div",ol,[s("span",null,n(e.$t("vehicles.vehicleList")),1),l(R,{modelValue:M.value,"onUpdate:modelValue":t[6]||(t[6]=o=>M.value=o),placeholder:e.$t("vehicles.searchPlate"),"prefix-icon":"Search",style:{width:"150px"}},null,8,["modelValue","placeholder"])])]),default:a(()=>[s("div",il,[(g(!0),$(le,null,te(ne.value,o=>(g(),$("div",{key:o.id,class:Ue(["vehicle-item",{active:C.value===o.id}]),onClick:X=>ie(o.id)},[s("div",cl,[s("div",ul,[s("span",rl,n(o.plateNumber),1),l(G,{type:H(o.status),size:"small"},{default:a(()=>[d(n(O(o.status)),1)]),_:2},1032,["type"])]),s("div",pl,[s("p",null,[s("strong",null,n(e.$t("vehicles.driverLabel")),1),d(n(o.driver),1)]),s("p",null,[s("strong",null,n(e.$t("vehicles.locationLabel")),1),d(n(o.location),1)]),s("p",null,[s("strong",null,n(e.$t("vehicles.speedLabel")),1),d(n(o.speed)+" km/h",1)]),s("p",null,[s("strong",null,n(e.$t("vehicles.updateLabel")),1),d(n(o.lastUpdate),1)])])]),s("div",ml,[l(u,{link:"",type:"primary",onClick:ae(X=>de(o),["stop"])},{default:a(()=>[d(n(e.$t("vehicles.details")),1)]),_:2},1032,["onClick"]),l(u,{link:"",type:"warning",onClick:ae(X=>ce(o),["stop"])},{default:a(()=>[d(n(e.$t("vehicles.command")),1)]),_:2},1032,["onClick"])])],10,dl))),128))])]),_:1})]),_:1})]),_:1}),l(J,{modelValue:S.value,"onUpdate:modelValue":t[7]||(t[7]=o=>S.value=o),title:e.$t("vehicles.vehicleDetail"),width:"600px"},{default:a(()=>[r.value?(g(),$("div",vl,[l($e,{column:2,border:""},{default:a(()=>[l(f,{label:e.$t("vehicles.plateNumber")},{default:a(()=>[d(n(r.value.plateNumber),1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.model")},{default:a(()=>[d(n(r.value.model),1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.driver")},{default:a(()=>[d(n(r.value.driver),1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.phone")},{default:a(()=>[d(n(r.value.phone),1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.currentStatus")},{default:a(()=>[l(G,{type:H(r.value.status)},{default:a(()=>[d(n(O(r.value.status)),1)]),_:1},8,["type"])]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.currentSpeed")},{default:a(()=>[d(n(r.value.speed)+" km/h ",1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.fuel")},{default:a(()=>[d(n(r.value.fuel)+"% ",1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.mileage")},{default:a(()=>[d(n(r.value.mileage)+" km ",1)]),_:1},8,["label"]),l(f,{label:e.$t("vehicles.lastUpdate"),span:2},{default:a(()=>[d(n(r.value.lastUpdate),1)]),_:1},8,["label"])]),_:1}),s("div",hl,[s("h4",null,n(e.$t("vehicles.todayRecord")),1),s("div",{ref_key:"mileageChart",ref:L,style:{height:"200px","margin-top":"10px"}},null,512)])])):F("",!0)]),_:1},8,["modelValue","title"]),l(J,{modelValue:T.value,"onUpdate:modelValue":t[12]||(t[12]=o=>T.value=o),title:e.$t("vehicles.commandDialogTitle"),width:"400px"},{footer:a(()=>[s("span",fl,[l(u,{onClick:t[11]||(t[11]=o=>T.value=!1)},{default:a(()=>[d(n(e.$t("common.cancel")),1)]),_:1}),l(u,{type:"primary",onClick:ue},{default:a(()=>[d(n(e.$t("vehicles.commandSend")),1)]),_:1})])]),default:a(()=>[l(Ce,{model:m,"label-width":"100px"},{default:a(()=>[l(E,{label:e.$t("vehicles.commandVehicle")},{default:a(()=>[l(R,{modelValue:m.vehicle,"onUpdate:modelValue":t[8]||(t[8]=o=>m.vehicle=o),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),l(E,{label:e.$t("vehicles.commandTypeLabel")},{default:a(()=>[l(q,{modelValue:m.type,"onUpdate:modelValue":t[9]||(t[9]=o=>m.type=o),style:{width:"100%"}},{default:a(()=>[l(V,{label:e.$t("vehicles.lockVehicle"),value:"lock"},null,8,["label"]),l(V,{label:e.$t("vehicles.unlockVehicle"),value:"unlock"},null,8,["label"]),l(V,{label:e.$t("vehicles.locate"),value:"locate"},null,8,["label"]),l(V,{label:e.$t("vehicles.stopEngine"),value:"stop"},null,8,["label"]),l(V,{label:e.$t("vehicles.horn"),value:"horn"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(E,{label:e.$t("vehicles.commandNoteLabel")},{default:a(()=>[l(R,{modelValue:m.note,"onUpdate:modelValue":t[10]||(t[10]=o=>m.note=o),type:"textarea",rows:"3",placeholder:e.$t("vehicles.commandNote")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),kl=Ae(_l,[["__scopeId","data-v-14ac0437"]]);export{kl as default};
