# 摄像头权限配置指南

## 问题说明

现代浏览器出于安全考虑，只允许在以下环境中访问摄像头：
- HTTPS 加密连接
- localhost 本地开发环境
- 127.0.0.1 本地回环地址

如果你的应用不在这些环境中运行，摄像头功能将无法使用。

## 解决方案

### 方案一：使用 HTTPS 开发环境（推荐）

1. 在项目根目录运行以下命令生成本地 HTTPS 证书：
   ```bash
   ./generate-cert.sh
   ```

2. 修改 `vite.config.ts`，启用 HTTPS：
   ```typescript
   export default defineConfig({
     // ... 其他配置
     server: {
       https: {
         key: './localhost-key.pem',
         cert: './localhost.pem'
       },
       host: 'localhost',
       port: 5173
     }
   })
   ```

3. 重启开发服务器：
   ```bash
   npm run dev
   ```

4. 访问 `https://localhost:5173`
   - 首次访问会提示证书不安全
   - 点击"高级" → "继续前往localhost（不安全）"
   - 现在可以正常使用摄像头功能

### 方案二：使用 localhost 访问

确保你通过以下地址之一访问应用：
- `http://localhost:5173`
- `http://127.0.0.1:5173`

**注意：** 不能使用 IP 地址（如 `http://192.168.1.100:5173`）或域名访问。

### 方案三：生产环境部署

在生产环境中，确保：
1. 使用 HTTPS 协议
2. 配置有效的 SSL 证书
3. 域名解析正确

## 浏览器权限设置

### Chrome
1. 点击地址栏左侧的锁形图标
2. 选择"摄像头" → "允许"
3. 刷新页面

### Firefox
1. 点击地址栏左侧的锁形图标
2. 选择"权限" → "摄像头" → "允许"
3. 刷新页面

### Safari
1. 选择"Safari" → "偏好设置"
2. 点击"网站"选项卡
3. 选择"摄像头"
4. 将目标网站设置为"允许"

## 常见问题

### Q: 提示"摄像头权限被拒绝"
A: 检查浏览器权限设置，确保允许该网站访问摄像头。

### Q: 提示"未找到摄像头设备"
A: 确保设备有可用的摄像头，并且没有被其他应用占用。

### Q: 提示"安全限制：请使用 HTTPS 或 localhost 访问"
A: 按照上述方案配置 HTTPS 或使用 localhost 访问。

### Q: 摄像头启动后是黑屏
A: 可能是摄像头硬件问题或驱动问题，尝试重启浏览器或设备。

## 测试步骤

1. 确保按照上述步骤配置 HTTPS 或 localhost 访问
2. 打开签到页面
3. 点击"启动摄像头"按钮
4. 允许浏览器访问摄像头权限
5. 摄像头应该正常启动并显示预览画面

## 技术支持

如果按照上述步骤仍无法解决问题，请检查：
1. 浏览器控制台是否有错误信息
2. 网络连接是否正常
3. 设备摄像头是否正常工作
4. 浏览器版本是否过旧

更多技术支持，请联系系统管理员。